@using SIGESDOC.Web.Seguridad

@model IEnumerable<SIGESDOC.Response.DocumentoDhcpaResponse>



@{
    //WebGrid grid = new WebGrid(rowsPerPage: ServiceConfiguration.PageSize, ajaxUpdateContainerId: "grid");    grid.Bind(Model, autoSortAndPage: false, rowCount: ViewBag.TotalRows);
    ViewBag.Title = "Consulta Documento Externos";
}
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>


<style>
    input[type="text"], select {
        width: 250px;
    }

    a:link, a:active, a:visited, a:hover {
        text-decoration: none;
        color: black;
    }
    /*--- DROPDOWN ---*/
    #nav ul {
        list-style: none;
        position: absolute;
        padding: 0;
        margin: 0;
        list-style-type: none;
    }
</style>

<ol class="breadcrumb" style="margin-bottom: 5px;">
    <li><a href="#">Habilitaciones</a></li>
    <li class="active">Consulta Documentos Externos</li>
</ol>

<div class="bs-callout bs-callout-info">
    <h4>Consulta Documentos Externos Emitidos</h4>
    <p>En esta sección usted puede Consultar los documentos emitidos</p>
</div>



<div class="modal fade" id="modalFirma" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">
                    <label id="txt_titulo">  </label>
                    <label id="HT_titulo">  </label>
                </h4>

            </div>
            <form method="post" id="formdestino">

                <ul class="nav nav-pills">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#proceso">Proceso de Firma Digital</a>
                    </li>
                    <li>
                        <a class="nav-link" data-toggle="tab" href="#editar">Editar</a>
                    </li>
                    <li>
                        <a class="nav-link" data-toggle="tab" href="#detalle">Detalle de Firma Digital</a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane container active" id="proceso">
                        <div class="modal-body">
                            @*Inicio Formulario*@
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="txtDestinatario">Destinatario:</label>
                                    <input type="text" class="form-control input-sm" id="txtDestinario" />
                                </div>
                                <div hidden="hidden" id="listaNombre" class="form-group">
                                    <label for="txtNombre">Colaborador:</label>
                                    <input type="text" class="form-control" id="txtNombre" name="txtNombre[]" />
                                    <ul id="selectedValue"></ul>

                                    <div class="col-md-1">
                                        <button type="button" id="btnAdd" value="+">
                                            <i class="green glyphicon glyphicon-plus-sign"></i>
                                        </button>
                                    </div>
                                    <div class="col-md-1">
                                        <button type="button" id="btnDel" value="-">
                                            <i class="red glyphicon glyphicon-minus-sign"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="exampleFormControlFile1">Subir Archivo PDF</label>
                                    <input type="file" class="form-control-file" id="upload">
                                </div>
                            </div>


                        </div>

                    </div>


                    <div class="tab-pane container fade" id="editar">

                    </div>
                    <div class="tab-pane container fade" id="detalle">
                        <div id="gridDetalle">
                            <table id="table_Detalle" class="table table-striped table-hover table-condensed tabla small">
                                <thead>
                                    <tr class="cabecera text-center">
                                        <th scope="col" style="display:none">ID_DOCUMENTO</th>
                                        <th scope="col" class="visible-lg visible-md">Nombre Documento</th>
                                        <th scope="col" class="visible-lg visible-md">Nombre Colaborador</th>
                                        <th scope="col" class="visible-lg visible-md">Estado</th>
                                        <th scope="col" class="visible-lg visible-md">Fecha Firmado</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (ViewData["firmados_tabla"] != null)
                                    {
                                        foreach (System.Data.DataRow dr in (ViewData["firmados_tabla"] as System.Data.DataTable).Rows)
                                        {
                                            <tr>
                                                <td style="text-align:center;">
                                                    <ul class="list-inline" style="margin-bottom:0">
                                                        <li>
                                                            @*<a class="Imprimir" href="#" title="Vacia">*@
                                                            <a id="" href="#" title="Proceso de Firma">
                                                                <i class="red glyphicon glyphicon-file"></i>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </td>
                                                @*<td class="visible-lg" style=" text-align:center;"> @dr["FECHA_DOCUMENTO"] </td>*@

                                                <td class="visible-lg" style=" text-align:center;">  </td>

                                                <td class="visible-lg" style=" text-align:center;">  </td>

                                                <td class="visible-lg" style=" text-align:center;">  </td>

                                                <td class="visible-lg" style=" text-align:center;">  </td>

                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>

                        </div>


                    </div>
                </div>

                <div class="modal-footer">
                    <a  class="btn btn-primary btn-sm" role="button" href="https://sp.reniec.gob.pe/app/refirma_suite/pdf/clickonce/ReFirmaPDF.exe" id="btnFirmaDigital">Firma Digital</a>
                    <button type="button" class="btn btn-primary btn-sm" id="btnGrabarFirma">Grabar</button>
                    <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-default btn-sm" id="btnLimpiar" onclick="LimparCamposModal()">Limpiar</button>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="modal fade" id="mdl_detalle" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-width">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">Destinos</h4>
            </div>

            <div class="modal-body">
                <div class="form-horizontal">

                    <div class="row">

                        <div id="grid_destino">
                            <table class="table table-striped table-hover table-condensed tabla small" data-swhgajax="true" data-swhgcontainer="grid" data-swhgcallback="" id="tblDestinoDetalle">
                                <thead>
                                    <tr class="cabecera">
                                        <th scope="col">Lugar</th>
                                        <th scope="col">Persona</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>
                            </table>
                        </div>

                    </div>

                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Salir</button>
            </div>

        </div>
    </div>
</div>

<div class="panel panel-primary">
    <div class="panel-heading panet-heading-sm">Búsqueda de Documentos</div>
    <div class="panel-body">
        @using (Ajax.BeginForm(new AjaxOptions { HttpMethod = "Get" }))
        {

            @Html.TextBox("txt_ID_OFICINA_DIRECCION", (int)ViewBag.ID_OFICINA_DIRECCION, new { @class = "form-control input-sm hidden" })
            <p>
                <div class="row">
                    <div class="col-lg-8">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">Asunto</span>
                            @Html.TextBox("asunto", null, new { @class = "form-control input-sm", @maxlength = "1000" })
                        </div>
                    </div>
                </div>
            </p>
            <p>
                <div class="row">

                    <div class="col-lg-4">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">Tipo Documento: </span>
                            @Html.DropDownList("cmbtipo_documento", (IEnumerable<SelectListItem>)ViewBag.lst_tipo_documento, new { @class = "form-control input-sm" })
                        </div>
                    </div>

                    <div class="col-lg-2">
                        <div class="input-group input-group-sm">
                            <span class="input-group-addon">Año: </span>
                            @Html.DropDownList("cmbanno_documento", (IEnumerable<SelectListItem>)ViewBag.lst_anno_documento, new { @class = "form-control input-sm" })
                        </div>
                    </div>
                </div>
            </p>
            <p>
                <div class="row">
                    <div class="col-lg-1">
                        <input type="submit" id="btnBuscar" class="btn btn-primary btn-sm pull-left" value="Actualizar" />
                    </div>
                    <button id="btnNuevoDocumento_cert" type="button" class="btn btn-primary btn-sm">Nuevo Documento</button>

                </div>
            </p>
        }
    </div>
</div>

@Html.ActionLink("Exportar a Excel", "Export_Excel_documentos_emitidos_externo", "Habilitaciones", new { para1 = "_Parameter1", para2 = "_Parameter2", para3 = "_Parameter3" }, new { id = "Documentos_excel" })

<div id="grid">
    <table id="grid_documento" class="table table-striped table-hover table-condensed tabla small">
        <thead>
            <tr class="cabecera text-center">
                <th scope="col" class="visible-lg visible-md">Opciones</th>
                <th scope="col">Tipo Documento</th>
                <th scope="col">Documento</th>
                <th scope="col" class="visible-lg">Fecha Documento</th>
                <th scope="col" class="visible-lg visible-md">Asunto</th>
                <th scope="col" class="visible-lg">Anexos</th>
                <th scope="col" style='display:none'>id_doc_dhcpa</th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>
                <th scope="col" style='display:none'></th>

                @*<th scope="col">Opciones</th>*@
            </tr>
        </thead>
        <tbody>
            @if (ViewData["documentos_tabla"] != null)
            {
                foreach (System.Data.DataRow dr in (ViewData["documentos_tabla"] as System.Data.DataTable).Rows)
                {
                    <tr>
                        <td style="text-align:center;">
                            <ul class="list-inline" style="margin-bottom:0">
                                <li>
                                    @*<a class="Imprimir" href="#" title="Vacia">*@
                                    <a class="idFirma" id=@dr["ID_DOC_DHCPA"] href="#" title="Proceso de Firma">
                                        <i class="red glyphicon glyphicon-file"></i>
                                    </a>
                                </li>
                            </ul>
                        </td>

                        @* Abrir modal en caso de ser cedula de notificacion*@
                        @if ((string)dr["NOM_TIPO_DOCUMENTO"] == "CARTA" || (string)dr["NOM_TIPO_DOCUMENTO"] == "OFICIO")
                        {
                            <td id="idnombredocumento" style=" text-align:center;"><a id="idtipodocumento" class="ver_pdf_docu"> @dr["NOM_TIPO_DOCUMENTO"]</a> </td>
                        }
                        else
                        {
                            <td id="idnombredocumento" style=" text-align:center;"> @dr["NOM_TIPO_DOCUMENTO"] </td>
                        }

                        @if (dr["PDF"].ToString() == "1")
                        {
                            <td style=" text-align:center;">
                                <ul class="list-inline" style="margin-bottom:0"><li><a href="@dr["RUTA_PDF"]" target="_blank"> @dr["DOCUMENTO"] </a></li></ul>
                            </td>
                        }
                        else
                        {
                            <td style=" text-align:center;"> @dr["DOCUMENTO"] </td>
                        }

                        <td class="visible-lg" style=" text-align:center;"> @dr["FECHA_DOCUMENTO"] </td>
                        <td class="visible-lg visible-md">  @dr["ASUNTO"] </td>
                        <td class="visible-lg"> @dr["ANEXO"] </td>
                        <td id="id_doc_dhcpa" style='display:none'>@dr["ID_DOC_DHCPA"]</td>
                        <td id="idnumdoc" style='display:none'> @dr["NUM_DOC"] </td>
                        <td id="EVALUADOR_CDL_NOTIF" style='display:none'> @dr["EVALUADOR_CDL_NOTIF"] </td>
                        <td id="DIRECCION_CDL_NOTIF" style='display:none'> @dr["DIRECCION_CDL_NOTIF"] </td>
                        <td id="EMPRESA_CDL_NOTIF" style='display:none'> @dr["EMPRESA_CDL_NOTIF"] </td>
                        <td id="FOLIA_CDL_NOTIF" style='display:none'> @dr["FOLIA_CDL_NOTIF"] </td>
                        <td id="DOC_NOTIFICAR_CDL_NOTIF" style='display:none'> @dr["DOC_NOTIFICAR_CDL_NOTIF"] </td>
                        <td id="EXP_O_HT_CDL_NOTIF" style='display:none'> @dr["EXP_O_HT_CDL_NOTIF"] </td>
                        <td id="EXP_O_HT_N_CDL_NOTIF" style='display:none'> @dr["EXP_O_HT_N_CDL_NOTIF"] </td>
                        <td id="RUC" style='display:none'> @dr["RUC"] </td>


                        @*<td>
                                <ul class="list-inline" style="margin-bottom:0">
                                    <li>
                                        <a class="Ver_Destino" id=@dr["ID_DOC_DHCPA"] href="#" title="Ver destino">
                                            <i class="blue glyphicon glyphicon-search"></i>
                                        </a>
                                    </li>
                                    @if (User.Identity.Name.Split('|')[4].Trim() == "7")
                                    {
                                        <li>
                                            <a class="Subir_archivo_doc_dhcpa" id=@dr["ID_DOC_DHCPA"] href="#" title="Cargar archivo">
                                                <i class="blue glyphicon glyphicon-upload"></i>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </td>*@
                    </tr>
                }
            }
        </tbody>

    </table>
</div>


@*<div id="grid">    @grid.GetHtml(        tableStyle: "table table-striped table-hover table-condensed tabla small",        headerStyle: "cabecera",        columns: new[] {            grid.Column(null, header:"Tipo Documento",format: p=> p.nom_tipo_documento),            grid.Column(null, header:"Documento",format: p=> p.num_doc.ToString()+p.nom_doc),            grid.Column(null, header:"Fecha Documento",format: p=> p.fecha_doc.ToShortDateString()),            grid.Column(null, header:"Asunto",format: p=> p.asunto),            grid.Column(null, header:"Anexos",format: p=> p.anexos),            grid.Column(null, header:"Opciones",format: p => MvcHtmlString.Create("<ul class='list-inline' style='margin-bottom:0'><li>"+                            Html.IconlinkItem("Ver destino", "Ver_Destino", (string)p.id_doc_dhcpa.ToString(), "glyphicon glyphicon-search", "blue", true).ToString()+ "</li></ul>")                       )        }                                         , footerStyle: "hidden"                                         )    @if (Model.Count() == 0)    {        <div class="row">            <div class="col-lg-12 text-center">                <div class="well well-sm">                    No se encontraron registros                </div>            </div>        </div>    }    else    {        <div class="row">            <div id="paginator" class="col-lg-12">                @grid.PagerList(mode: WebGridPagerModes.All, firstText: "Primero", previousText: "Anterior", nextText: "Siguiente", lastText: "Último")            </div>        </div>    }</div>*@

<script type="text/javascript">
    var pathfile;
    var campos_max = 15;
    var x = 0;

    var textbox;
    var selectValue;

    $('#btnAdd').click(function (e) {
        e.preventDefault();

        if (x < campos_max) {
            $('#listaNombre').append('<label for="txtNombre">Colaborador:</label>\<input type="text" class="form-control" id="txtNombre" name="txtNombre[]" />\<ul id="selectedValue"></ul>');
            x++;
        }
    });

    $('#btnDel').click(function (e) {

        e.preventDefault();
        $(this).parent('div').remove();
    });

     $(function () {
        textbox = $("#txtNombre");
        selectValue = $('ul#selectedValue');
                textbox.on("input", function () {
                     getAutoComplete(textbox.val());
            });
        });

    function getAutoComplete(Nombres) {

            var uri = '/HojaTramite/GetColaboradores';
            $.getJSON(uri, { Nombres: Nombres })
            .done(function (data) {
           selectValue.html("");
           var count = 0;
                $.each(data, function (key, item) {
                    console.log(data);
                    console.log(item);
                    console.log(key);
               //$('<option>').text(item).appendTo('#selectedValue');
               var li = $('<li/>').addClass('ui-menu-item').attr('role', 'menuitem')
                   .html("<a href='#' onclick=\"setText('" + item.nombres + "')\">" + item.persona_num_documento + '  ' + item.nombres+ "</a>")
                  // .html("<a href='#' onclick=\"setText('" + item.nombres + "')\"></a>")
                   .appendTo(selectValue);
               count++;
           });
       });
    }

   function setText(text) {
        textbox.val(text);
        getAutoComplete(text);
    }

    function LimparCamposModal() {
        $("#txtNombre").val(' ');
        $('#selectedValue').val(' ');
        $('#txtDestinatio').val(' ');
    }

    $(document).ready(function () {


        function init() {
            var sName, sDescription;
            var i, j;

            try {
                sName = unescape(location.href)

                i = sName.lastIndexOf(".")
                if (i >= 0) { sName = sName.substring(1, i); }

                i = sName.lastIndexOf("/")
                if (i >= 0) { sName = sName.substring(i + 1, sName.length); }

                document.title = sName;
                document.getElementById("tdName").innerText = sName;

                sDescription = document.getElementById("docprops").innerHTML;

                i = sDescription.indexOf("escription>")
                if (i >= 0) { j = sDescription.indexOf("escription>", i + 11); }

                if (i >= 0 && j >= 0) {
                    j = sDescription.lastIndexOf("</", j);

                    if (j >= 0) {
                        sDescription = sDescription.substring(i + 11, j);
                        if (sDescription != "") {
                            document.getElementById("tdDesc").style.fontSize = "x-small";
                            document.getElementById("tdDesc").innerHTML = sDescription;
                        }
                    }
                }
            }
            catch (e) {

            }
        }

 $('input[type="file"]').on('change', function(){
  var ext = $( this ).val().split('.').pop();
  if ($( this ).val() != '') {
    if(ext == "pdf"){
      if($(this)[0].files[0].size > 10048576){
        console.log("El documento excede el tamaño máximo");
        $('#modal-title').text('¡Precaución!');
        $('#modal-msg').html("Se solicita un archivo no mayor a 1MB. Por favor verifica.");
        $("#modal-gral").modal();           
        $(this).val('');
      }else{
        $("#modal-gral").hide();
      }
    }
    else
    {
      $( this ).val('');
      alert("Extensión no permitida: " + ext);
    }
  }
});


        //$(function () { $('#paginator ul li a').click(function () { var url = $(this).attr('href') + '&' + $('form').serialize(); $(this).attr('href', url); }); });

        $(document).on('click', '.Subir_archivo_doc_dhcpa', function () {
            var id_doc_dhcpa = $(this).attr('id');
            var url_scan = "/Habilitaciones/variable_Subir_archivo_doc_externo/" + id_doc_dhcpa.toString();
            window.location.href = url_scan;
        });

        $("#grid_documento").DataTable({
            "ordering" : false,
            "lengthChange": false,
            "searching": false,
            //"info": false,
            "language": {
                "paginate": {
                    "previous": "Anterior",
                    "next": "Siguiente"
                }
            }
        });

        //Add by HM - 14/11/2019
        //$('#grid_documento tbody').on('click', '#idtipodocumento', function () {
        //    var table = $('#grid_documento').DataTable();
        //    var tr = $(this).closest('tr');
        //    var row = table.row(tr);
        //    var nuevoTD = '<tr>';
        //    console.log(row.data());
        //    //Limpiar
        //    $("#tblDestinoDetalle td").remove();

        //    nuevoTD += '<td>' + row.data()[11] + '</td>';//Exp O Ht N°
        //    nuevoTD += '<td>' + row.data()[10] + '</td>';//Exp. O Ht
        //    nuevoTD += '<td>' + row.data()[9] + '</td>';//Documento a Notificar
        //    nuevoTD += '<td>' + row.data()[8] + '</td>';//N° Folios
        //    nuevoTD += '<td>' + row.data()[7] + '</td>';//Empresa
        //    nuevoTD += '<td>' + row.data()[6] + '</td>';//Dirección
        //    nuevoTD += '<td>' + row.data()[5] + '</td>';//Evaluador

        //    //Columna Opciones OPCIONES
        //    nuevoTD += '<td>';
        //    nuevoTD += '<ul class="list-inline" style="margin-bottom:0; text-align: center">';
        //    nuevoTD += '<li>';
        //    //nuevoTD += '<a  id="icon_word" href="/WORD_ACTA_DE_ NOTIFICACIÓN.docx" title="Ver documento en Word">';
        //    nuevoTD += '<a  id="icon_word" href="#" title="Ver documento en Word">';
        //    nuevoTD += '<i class="blue glyphicon glyphicon-file"></i>';
        //    nuevoTD += '</a>';
        //    nuevoTD += '</li>';
        //    nuevoTD += '</ul>';
        //    nuevoTD += '</td>';

        //    nuevoTD += '</tr>';
        //    jQuery("#tblDestinoDetalle").append(nuevoTD);

        //    $('#cdl_notificacion_detalle').modal('show');

        //});

        $('.idFirma').on('click', function (){

            $('#modalFirma').modal();

            $.ajax({
                cache: false,
                type: 'GET',
                url: '/HojaTramite/GetDestinatario',
                data: {'ID_DOC_DHCPA':  $(this).parents("tr").find("td").eq(6).text()},
                sucess: function () {
                    console.log(data[0]);
                    console.log(data['encargado']);
                     $('#txtDestinario').text(data['encargado']);
                },
                error: function () {
                }
            });
        });


        document.getElementById('upload').onchange = function () {
            console.log(this.value);
            pathfile = document.getElementById('upload').files[0].name;
            console.log(pathfile);
        }

        $('#btnGrabarFirma').click(function () {

            var namefile = document.getElementById('upload').files[0].name;
            var contentype = document.getElementById('upload').files[0].type;
            var destinatario = $('#txtDestinario').val();
            var visados = $('#txtNombre').val();
            var id_documento =  $(this).parents("tr").find("td").eq(6).text();
            var nom_doc = $(this).parents("tr").find("td").eq(1).text();

            var request = [{
                    persona_firmar: destinatario,
                    id_documento: id_documento,
                    nom_doc: nom_doc,
                    pathFilePDF: 'C:/SIGESDOC/PDF/' + namefile, 
                    filename : namefile,
                    contentype : contentype
                }];
             request.push({
                    persona_firmar: visados,
                    id_documento: id_documento,
                    nom_doc: nom_doc,
                    pathFilePDF: 'C:/SIGESDOC/PDF/' + namefile,
                    filename: namefile,
                    contentype:contentype
                });
            console.log(request);
            $.ajax({

                cache: false, 
                type: 'POST',
                url: '/Habilitaciones/Create_Firma_Digital',
                dataType: 'json',
                data: {strrequest : JSON.stringify(request) },
                sucess: function (data) {
                    alert('Registro Realizado con Sucesso')
                },
                error: function () {

                }


            });

        });


        $('#Documentos_excel').attr('href', function () {
            //return this.href.replace('_Parameter1', "").replace('_Parameter2', "");
            return this.href.replace('_Parameter1', $("#cmbtipo_documento").val()).replace('_Parameter2', $("#cmbanno_documento").val()).replace('_Parameter3', $("#txt_ID_OFICINA_DIRECCION").val());
        });

        $(document).on('click', '.Ver_Destino', function () {

            $('#mdl_detalle').modal('show');
            var id_documento_emitido = $(this).attr('id');
            $("#tblDestinoDetalle td").remove();

            $.ajax({
                cache: false,
                type: "GET",
                url: "@(Url.RouteUrl("llenar_destino_emitidos"))",
                data: { "id_doc_dhcpa": id_documento_emitido },
                success: function (data) {
                    $.each(data, function (id, option) {
                        var nuevoTD = '<tr>';
                        nuevoTD += '<td>' + option.Text + '</td>';
                        nuevoTD += '<td>' + option.Value + '</td>';
                        nuevoTD += '</tr>';

                        jQuery("#tblDestinoDetalle").append(nuevoTD);
                    });
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert('Failed to retrieve states.');
                }
            });

        });

        $('#btnNuevoDocumento').click(function () {
            var url = "/Habilitaciones/Nuevo_Documento_dhcpa/";
            window.location.href = url;
        });
        $('#btnNuevoDocumento_cert').click(function () {
            //var url = "/Habilitaciones/Nuevo_Documento_dhcpa_Certificaciones/";
            var url = "/Habilitaciones/Nuevo_Documento_Externos/";
            window.location.href = url;
        });


        //$('#grid tr').click(function () {
        $('#idnombredocumento').click(function () {

           var tableData = [];
            tableData = {
                'NOM_DOC':$(this).parents("tr").find("td").eq(1).text(),
                'ID_DOCUMENTO': $(this).parents("tr").find("td").eq(6).text(),
                'ID_DOCUMENTO': $(this).parents("tr").find("td").eq(6).text(),
                
            };

            var oficina = tableData['NOM_DOC'].trim();
            var ddd = tableData['ID_DOCUMENTO'].trim();
            console.log(ddd);
            console.log(oficina);
            console.log(oficina.split(" "));
            var documento = oficina.split(" ");
            console.log(documento);

            var nom_documento;
            var num_documento;
            console.log(documento);

            if (documento.length== 4) {
                
                nom_documento = documento[0].trim() + " " + documento[1].trim();
                num_documento = documento[2].trim();

            } else {
                nom_documento = documento[0].trim();
                num_documento = documento[1];
            }

            if (nom_documento == "CEDULA DE NOTIFICACION") {

                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "/Documents/CedulaNotificacionWord",
                    data: {
                        "NON_DOC": tableData['NOM_DOC'],
                        "ASUNTO": tableData[3],
                        "DIRECCION_CDL_NOTIF": tableData[7],
                        "EMPRESA_CDL_NOTIF": tableData[8],
                        "FOLIA_CDL_NOTIF": tableData[9],
                        "DOC_NOTIFICAR_CDL_NOTIF": tableData[10],
                        "EXP_O_HT_N_CDL_NOTIF": tableData[12],
                        'ID_DOCUMENTO': tableData['ID_DOCUMENTO'].trim(),

                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "RESOLUCION DIRECTORAL") {

                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "/Documents/ResolucionDirectoralWord",
                    data: {
                        "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        "EMPRESA_CDL_NOTIF": tableData[8],
                        "RUC": tableData[13],
                        'ID_DOCUMENTO': tableData['ID_DOCUMENTO'].trim(),
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });
            } else if (nom_documento == "OFICIO") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/OficioWord",
                    data: {
                        "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        "ASUNTO": tableData[5],
                        "CARGO": tableData[5],
                        "DIRECCION": tableData[5],
                        "NOMBRES": tableData[5],
                        "REFERENCIA": tableData[5],
                        'ID_DOCUMENTO':tableData['ID_DOCUMENTO'].trim(),
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "INVITACION") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/InvitacionWord",
                    data: {
                        "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        'ID_DOCUMENTO': tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "RESOLUCION") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/ResolucionWord",
                    data: {
                         "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        'ID_DOCUMENTO': tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "INFORME") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/InformeWord",
                    data: {
                         "NON_DOC": tableData['NOM_DOC'],
                        "ASUNTO": tableData[5],
                        "REFERENCIA": tableData[5],
                        'ID_DOCUMENTO': tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "COMUNICADO") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/ComunicadoWord",
                    data: {
                         "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        "ID_DOCUMENTO": tableData['ID_DOCUMENTO'].trim()

                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "CARTA MULTIPLE") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/CartaMultipleWord",
                    data: {
                        "NON_DOC": tableData['NOM_DOC'],
                        "EXPEDIENTE": tableData[5],
                        "ID_DOCUMENTO": tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "OFICIO MULTIPLE") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/OficioMultipleWord",
                    data: {
                        "NON_DOC": tableData["NOM_DOC"],
                        "EXPEDIENTE": tableData[5],
                        "ID_DOCUMENTO": tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "MEMORANDO") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/MemorandoWord",
                    data: {
                        "NOM_DOC": tableData["NOM_DOC"],
                        "ASUNTO": tableData[3],
                        "REFERENCIA": tableData[1],
                        "NOMBRES": tableData[5],
                        "ID_DOCUMENTO": tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "MEMORANDO MULTIPLE") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/MemorandoMultipleWord",
                    data: {
                        "NON_DOC": tableData["NOM_DOC"],
                        "EXPEDIENTE": tableData[5],
                        "ID_DOCUMENTO": tableData['ID_DOCUMENTO'].trim()
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }

                });

            } else if (nom_documento == "CARTA") {

                $.ajax({

                    cache: false,
                    type: "GET",
                    url: "/Documents/CartaWord",
                    data: {
                        "NOM_DOC": tableData["NOM_DOC"],
                        "EXPEDIENTE": tableData[5],
                        "ASUNTO": tableData[5],
                        "CARGO": tableData[5],
                        "DIRECCION": tableData[5],
                        "NOMBRES": tableData[5],
                        "REFERENCIA": tableData[5],
                        "ID_DOCUMENTO": tableData["ID_DOCUMENTO"],
                        "TIPO_DOCUMENTO": "Consulta Documento Externos"
                    },
                    sucess: function () {
                        window.Alert('Documento Encontrado');
                    },
                    error: function (xhr, ajaxOptions, thownError) {
                        alert('Failed to retrieve states.');
                    }
           });

         }

        });

        $(document).ready(function () {

            $("#icon_word").click(function () {
                window.alert('Word');

            });

        });

    });
</script>

